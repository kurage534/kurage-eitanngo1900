<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç®¡ç†è€…ãƒšãƒ¼ã‚¸</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<script>
if (sessionStorage.getItem("ADMIN_LOGIN") !== "YES") {
  alert("ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™");
  location.href = "admin-login.html";
}
</script>

<h1>ç®¡ç†è€…ãƒšãƒ¼ã‚¸</h1>

<h2>ğŸ“Š å•é¡Œåˆ¥ãƒŸã‚¹åˆ†æ</h2>

<table border="1" cellpadding="8">
  <thead>
    <tr>
      <th>å˜èª</th>
      <th>ãƒŸã‚¹å›æ•°</th>
    </tr>
  </thead>
  <tbody id="miss-table">
    <tr><td colspan="2">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
  </tbody>
</table>

<hr>

<h2>âš  ãƒ©ãƒ³ã‚­ãƒ³ã‚°å…¨å‰Šé™¤</h2>
<input id="pass" type="password" placeholder="ç®¡ç†ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
<button id="deleteBtn">å‰Šé™¤</button>
<div id="msg"></div>

<br>
<a href="index.html">â† æˆ»ã‚‹</a>

<script>
const passInput = document.getElementById("pass");

// ãƒŸã‚¹åˆ†æèª­ã¿è¾¼ã¿
async function loadMiss() {
  const pass = passInput.value || prompt("ç®¡ç†ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰");
  if (!pass) return;

  const res = await fetch(`/api/admin/miss?pass=${encodeURIComponent(pass)}`);
  if (!res.ok) {
    alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
    return;
  }

  const data = await res.json();
  document.getElementById("miss-table").innerHTML =
    data.map(x => `
      <tr>
        <td>${x.word}</td>
        <td>${x.miss_count}</td>
      </tr>
    `).join("");
}
loadMiss();
  <hr>

<h2>ğŸ“¥ CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h2>

<button id="csvRanking">ãƒ©ãƒ³ã‚­ãƒ³ã‚°CSV</button>
<button id="csvMiss">ãƒŸã‚¹åˆ†æCSV</button>


// å‰Šé™¤
document.getElementById("deleteBtn").onclick = async () => {
  const pass = passInput.value;
  const res = await fetch("/api/admin/delete", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ pass })
  });
  const r = await res.json();
  document.getElementById("msg").textContent =
    r.result === "deleted" ? "å‰Šé™¤ã—ã¾ã—ãŸ" : "å¤±æ•—";
};
</script>
<script>
const passInput = document.getElementById("pass");

document.getElementById("csvRanking").onclick = () => {
  const pass = passInput.value || prompt("ç®¡ç†ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰");
  if (!pass) return;
  location.href = `/api/admin/export/ranking?pass=${encodeURIComponent(pass)}`;
};

document.getElementById("csvMiss").onclick = () => {
  const pass = passInput.value || prompt("ç®¡ç†ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰");
  if (!pass) return;
  location.href = `/api/admin/export/miss?pass=${encodeURIComponent(pass)}`;
};
</script>


</body>
</html>

